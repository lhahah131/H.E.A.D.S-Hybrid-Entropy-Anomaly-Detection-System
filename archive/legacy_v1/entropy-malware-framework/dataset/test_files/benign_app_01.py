"""
A simple inventory management system in memory.
Defines classes for items and the inventory container.
"""

class InventoryItem:
    def __init__(self, item_id, name, category, quantity, price):
        self.item_id = item_id
        self.name = name
        self.category = category
        self.quantity = quantity
        self.price = price

    def add_stock(self, amount):
        if amount > 0:
            self.quantity += amount
            return True
        return False

    def remove_stock(self, amount):
        if amount > 0 and self.quantity >= amount:
            self.quantity -= amount
            return True
        return False

    def total_value(self):
        return self.quantity * self.price

    def to_dict(self):
        return {
            "id": self.item_id,
            "name": self.name,
            "category": self.category,
            "quantity": self.quantity,
            "price": self.price,
            "value": self.total_value()
        }

class InventoryManager:
    def __init__(self):
        self._items = {}
        self._next_id = 1

    def add_item(self, name, category, quantity, price):
        item_id = f"item_{self._next_id}"
        self._next_id += 1
        
        new_item = InventoryItem(item_id, name, category, quantity, price)
        self._items[item_id] = new_item
        return item_id

    def remove_item(self, item_id):
        if item_id in self._items:
            del self._items[item_id]
            return True
        return False

    def update_stock(self, item_id, quantity_change):
        item = self._items.get(item_id)
        if not item:
            return False
            
        if quantity_change > 0:
            return item.add_stock(quantity_change)
        elif quantity_change < 0:
            return item.remove_stock(abs(quantity_change))
        return True

    def get_items_by_category(self, category):
        results = []
        for item in self._items.values():
            if item.category.lower() == category.lower():
                results.append(item.to_dict())
        return results

    def get_inventory_summary(self):
        total_items = sum(item.quantity for item in self._items.values())
        total_value = sum(item.total_value() for item in self._items.values())
        unique_categories = {}
        
        for item in self._items.values():
            unique_categories[item.category] = unique_categories.get(item.category, 0) + item.quantity

        return {
            "total_items": total_items,
            "total_value": total_value,
            "categories": len(unique_categories),
            "stock_by_category": unique_categories
        }

if __name__ == "__main__":
    inventory = InventoryManager()
    id1 = inventory.add_item("laptops", "electronics", 10, 999.99)
    id2 = inventory.add_item("keyboards", "electronics", 50, 49.99)
    id3 = inventory.add_item("chairs", "furniture", 20, 150.0)

    inventory.update_stock(id1, -2)
    print("inventory summary:", inventory.get_inventory_summary())
